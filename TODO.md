# 项目扩展 TODO

## 项目全局

- [ ] RPC 请求类中支持携带参数列表，可以用于安全校验。比如服务提供者参数列表、服务消费者参数列表，服务端接收到请求后可以根据参数列表中的值，判断如何进一步处理，比如在参数列表中携带 token 可以实现安全校验。📅
- [x] 项目支持读取 `.yml / .yaml` 等不同格式的配置文件，作为全局配置。仿照现有的 `ConfigUtil` 工具类，支持更多读取配置的方式，甚至可以使用 SPI 机制允许开发则二次扩展配置解析器。
- [ ] 实现拦截器机制，服务调用前和服务调用后可以执行额外的操作。可以参考 SpringMVC 或者 Servlet 的 Filter 机制，使用责任链模式实现；可以在服务提供者处理前后、服务消费者调用前后增加拦截器，用于进行日志校验、安全校验等。还可以使用 SPI 机制，支持用户自定义拦截器。
- [ ] 自定义异常。自定义异常类 `RpcException`，根据业务区分错误码，比如消费者异常、注册中心异常、提供者异常等等，让报错信息更清晰明确。
- [ ] 服务支持指定版本号。目前已经预留了版本字段，但都是默认值，还需要从服务提供者再到消费者代理调用的一条完整路径上应用版本号。
- [ ] 支持消费方指定某个服务级别的负载均衡器、重试策略、容错机制。目前只能通过全局配置改变对所有服务的负载均衡调用规则。实现的话可能需要修改 `ServiceProxy` 类，让它支持传参，根据消费者端的配置来动态创建 `ServiceProxy`。
- [ ] 服务消费方支持设定超时时间。可以通过修改 TCP 客户端请求相关的代码实现。

## 全局配置

- [x] 支持读取 `.yml / .yaml` 等不同格式的配置文件。
- [x] 配置文件支持中文，注意编码问题。

## RPC Mock

- [x] 完善 Mock 的逻辑，支持更多类型的默认值生成，考虑使用 Faker 之类的库来伪造数据生成，生成默认值。

## 序列化

- [x] 实现更多不同协议的序列化器，比如 `Protobuf`、`Hessian`、`FastJson` 等等。
- [x] 序列化工厂懒加载的方式创建序列化器实例。

## SPI

- [x] `SpiLoader` 支持懒加载，获取实例时才加载对应的类。

## 注册中心

- [x] 完善服务注册信息：节点注册时间等等。

- [x] 实现更多注册中心：比如 Redis。

## 重试机制

- [x] 新增更多的不同类型的重试器。

## 容错机制

- [x] 实现 `Fail-Back` 机制，参考 Dubbo Mock 能力，让消费端调用失败后执行本地服务和方法。
- [x] 实现 `Fail-Over` 机制，利用容错上下文传递服务节点参数和本地调用的服务节点。
- [x] 实现更多容错方案，比如限流、熔断、超时控制等；或者将重试机制作为容错机制的一种策略来实现。

## 启动机制

- [x] Starter 支持读取 `yml / yaml` 配置文件来启动 RPC 框架。
- [ ] 服务提供者启动逻辑也可以将 bean 后置执行改为「使用组件扫描」